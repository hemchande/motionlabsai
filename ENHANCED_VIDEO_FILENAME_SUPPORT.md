# Enhanced Video Filename Support for Frontend

## Overview
Updated the frontend to properly handle enhanced video filenames generated by the `/analyzevideo2` endpoint, which creates videos with patterns like `enhanced_analyzed_temp_{timestamp}_{original_filename}_{timestamp}.mp4`.

## Changes Made

### 1. Created Centralized Utility Function
**File**: `src/lib/utils.ts`
- Added `extractVideoBaseName()` function to handle all video filename patterns
- Supports extraction from various processed video filename formats:
  - `enhanced_analyzed_temp_{timestamp}_` prefix
  - `h264_analyzed_temp_{timestamp}_` prefix
  - `api_generated_` prefix
  - `analyzed_` prefix
  - `overlayed_` prefix
  - And other existing patterns

### 2. Updated Session Dashboard
**File**: `src/components/SessionDashboard.tsx`
- Imported and used `extractVideoBaseName()` utility function
- Replaced manual regex-based filename extraction with centralized function
- Fixed TypeScript error handling for unknown error types

### 3. Updated Interactive Video Player
**File**: `src/components/InteractiveVideoPlayer.tsx`
- Imported and used `extractVideoBaseName()` utility function
- Updated baseName extraction logic to handle enhanced video filenames
- Maintains backward compatibility with existing filename patterns

### 4. Updated Auto Analyzed Video Player
**File**: `src/components/AutoAnalyzedVideoPlayer.tsx`
- Imported and used `extractVideoBaseName()` utility function
- Updated baseName extraction logic for enhanced video filenames
- Preserves existing functionality for other video types

### 5. Coach and Athlete Dashboards
**Files**: `src/components/CoachDashboard.tsx`, `src/components/AthleteDashboard.tsx`
- These components use `session.processedVideoFilename` directly
- No changes needed as the backend now handles enhanced filenames correctly
- The `/getPerFrameStatistics` endpoint was updated to handle these patterns

## Supported Filename Patterns

The frontend now correctly handles these video filename patterns:

### Enhanced Analytics Videos
- `enhanced_analyzed_temp_1758208660_myaNew_1758208661.mp4`
- Extracts to: `myaNew`

### H.264 Processed Videos
- `h264_analyzed_temp_1758208660_myaNew_1758208661.mp4`
- Extracts to: `myaNew`

### Legacy Patterns (Still Supported)
- `api_generated_myaNew.mp4` → `myaNew`
- `analyzed_myaNew.mp4` → `myaNew`
- `overlayed_myaNew.mp4` → `myaNew`
- `enhanced_replay_myaNew.mp4` → `myaNew`
- `acl_risk_overlay_myaNew.mp4` → `myaNew`
- `fixed_overlayed_analytics_myaNew.mp4` → `myaNew`
- `downloaded_overlayed_myaNew.mp4` → `myaNew`

## Backend Integration

The frontend changes work in conjunction with the backend updates:

1. **Backend**: `/getPerFrameStatistics` endpoint now handles enhanced filenames
2. **Backend**: Extracts original filename from enhanced patterns for session lookup
3. **Frontend**: Uses extracted base name to call the correct analytics endpoint

## Testing

To test the enhanced filename support:

1. Process a video using `/analyzevideo2` endpoint
2. Check that the session dashboard shows the processed video
3. Verify that per-frame statistics load correctly
4. Confirm that video replay works with analytics overlay

## Benefits

- **Consistent**: All components now use the same filename extraction logic
- **Maintainable**: Centralized utility function for easy updates
- **Backward Compatible**: Existing video types continue to work
- **Future-Proof**: Easy to add support for new filename patterns

## Files Modified

1. `src/lib/utils.ts` - Added utility function
2. `src/components/SessionDashboard.tsx` - Updated filename extraction
3. `src/components/InteractiveVideoPlayer.tsx` - Updated filename extraction
4. `src/components/AutoAnalyzedVideoPlayer.tsx` - Updated filename extraction

## No Changes Needed

- `src/components/CoachDashboard.tsx` - Uses processedVideoFilename directly
- `src/components/AthleteDashboard.tsx` - Uses processedVideoFilename directly
- `src/lib/api.ts` - API methods unchanged
- `src/hooks/useGymnasticsAPI.ts` - Hook unchanged





